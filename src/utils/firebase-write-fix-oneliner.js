// Copy and paste this one-liner into your browser console to fix Firebase WebChannel Write stream issues:
(function(){console.group("🔧 Firebase Write Fix");try{const e=window.db||window._fixed_db;if(!e)return console.error("❌ Could not find Firestore instance. Run the Firebase fix script first."),void console.groupEnd();console.log("✅ Found Firestore instance");const o=new Proxy(e,{get:(e,o)=>{const r=e[o];return"function"==typeof r&&("collection"===o||"doc"===o||"batch"===o||"runTransaction"===o)?function(...o){const t=r.apply(e,o);return t&&"object"==typeof t?new Proxy(t,{get:(e,o)=>{const r=e[o];return"function"==typeof r&&("add"===o||"set"===o||"update"===o||"delete"===o)?async function(...o){try{return await r.apply(e,o)}catch(t){if(console.error("[Firebase] Write operation failed:",t),t.message?.includes("jd")||t.message?.includes("Bad Request")||t.message?.includes("400"))return console.log("[Firebase] Detected WebChannel Write error, retrying..."),await new Promise(e=>setTimeout(e,1e3)),r.apply(e,o);throw t}}:r}}):t}:r}});window.db=o,window._fixed_db=o,console.log("✅ Applied Write stream error handling"),console.log("🔄 Write operations will now automatically retry if they fail due to WebChannel errors"),console.log("Testing write operation...");const r=e.collection("_test_write").doc("_test_doc_"+Date.now());r.set({test:!0}).then(()=>(console.log("✅ Write test successful"),r.delete())).then(()=>{console.log("✅ Delete test successful")}).catch(e=>{console.error("❌ Write test failed:",e)})}catch(e){console.error("❌ Error applying Write stream fix:",e)}console.groupEnd()})(); 